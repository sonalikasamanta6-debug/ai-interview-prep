<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Interview Practice</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <div class="container">
    <h1>ü§ñ AI Interview Practice</h1>
    <p id="timer">05:00</p>
    <div id="chatBox" class="chat-box"></div>
    <textarea id="userInput" placeholder="Type your answer..."></textarea>
    <button id="sendBtn" class="btn">Send</button>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    const { jsPDF } = window.jspdf;

    const questions = [
      { q: "What is Artificial Intelligence?", a: "AI simulates human intelligence in machines." },
      { q: "Name a major ML paradigm.", a: "supervised" },
      { q: "What is Deep Learning?", a: "neural networks" },
      { q: "What does NLP stand for?", a: "natural language processing" },
      { q: "What is model overfitting?", a: "overfitting" }
    ];

    let qIndex = 0, score = 0, time = 300;
    let answers = [];
    const chat = document.getElementById("chatBox");
    const input = document.getElementById("userInput");
    const timer = document.getElementById("timer");

    function speak(text) {
      const utter = new SpeechSynthesisUtterance(text);
      utter.lang = "en-US";
      utter.rate = 1;
      speechSynthesis.speak(utter);
    }

    function askQuestion() {
      if (qIndex < questions.length) {
        const q = questions[qIndex].q;
        chat.innerHTML += `<p><strong>Q${qIndex + 1}:</strong> ${q}</p>`;
        speak(q);
      } else finishInterview();
    }

    function updateTimer() {
      const mins = Math.floor(time / 60);
      const secs = time % 60;
      timer.textContent = `${mins}:${secs.toString().padStart(2, "0")}`;
      if (time-- > 0) setTimeout(updateTimer, 1000);
      else finishInterview();
    }

    document.getElementById("sendBtn").onclick = () => {
      const val = input.value.trim();
      if (!val) return;

      const correct = questions[qIndex].a.toLowerCase();
      const isCorrect = val.toLowerCase().includes(correct);
      if (isCorrect) score++;

      answers.push({
        question: questions[qIndex].q,
        yourAnswer: val,
        correct: questions[qIndex].a,
        result: isCorrect ? "‚úÖ Correct" : "‚ùå Incorrect"
      });

      chat.innerHTML += `<p>üí¨ ${val}</p><p>${isCorrect ? "‚úÖ Correct!" : "‚ùå Not quite. Correct: " + questions[qIndex].a}</p>`;
      input.value = "";
      qIndex++;
      askQuestion();
    };

    function finishInterview() {
      const percent = ((score / questions.length) * 100).toFixed(1);
      chat.innerHTML += `<p>üèÅ Interview finished ‚Äî Score: ${score}/${questions.length} (${percent}%)</p>`;
      generatePDF(percent);
    }

    function generatePDF(percent) {
      const doc = new jsPDF();
      let y = 20;

      doc.setFontSize(18);
      doc.text("AI Interview Practice Report", 20, y);
      y += 10;
      doc.setFontSize(12);
      doc.text(`Date: ${new Date().toLocaleString()}`, 20, y);
      y += 10;
      doc.text(`Score: ${percent}%`, 20, y);
      y += 10;
      doc.line(20, y, 190, y);
      y += 10;

      answers.forEach((item, i) => {
        doc.text(`Q${i + 1}: ${item.question}`, 20, y);
        y += 8;
        doc.text(`Your Answer: ${item.yourAnswer}`, 25, y);
        y += 8;
        doc.text(`Correct: ${item.correct}`, 25, y);
        y += 8;
        doc.text(`${item.result}`, 25, y);
        y += 10;
        if (y > 270) { doc.addPage(); y = 20; }
      });

      doc.save(`AI_Interview_Result_${Date.now()}.pdf`);
    }

    chat.innerHTML = "<p>Welcome ‚Äî your timed interview starts now!</p>";
    askQuestion();
    updateTimer();
  </script>
</body>
</html>
